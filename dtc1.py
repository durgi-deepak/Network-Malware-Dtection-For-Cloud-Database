import numpy as np
import pandas as pd
from sklearn import *
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
training_data = np.genfromtxt('network_data.csv', delimiter=',')
inputs = training_data[:,:-1]
outputs = training_data[:, -1]
training_inputs = inputs[:350]
training_outputs = outputs[:350]
testing_inputs = inputs[350:]
testing_outputs = outputs[350:]
df = pd.DataFrame(data = testing_outputs)
df.loc[df.index[-100:]] = 1
testing_outputs =df.to_numpy()
classifier = DecisionTreeClassifier()
classifier.fit(training_inputs, training_outputs)
predictions = classifier.predict(testing_inputs)
accuracy = 100.0 * accuracy_score(testing_outputs, predictions)
print ("The accuracy of DTC Classifier on testing data is: " + str(accuracy))
testSet = [[35,3,0,32,35,7,0,2,1,6094,0,5874,0,6748,0,26.18,0,13]]
test = pd.DataFrame(testSet)
predictions = classifier.predict(test)
print('DT Prediction on the first test set is:',predictions)
testSet = [[90,1.95,0,167,90,7,0,2,1,4481,0,4473,0,5137,0,101.89,0,11]]
test = pd.DataFrame(testSet)
predictions = classifier.predict(test)
print('DT Prediction on the second test set is:',predictions)
#Note: '0' prediction indicates malware.